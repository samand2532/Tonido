%byhandcellbycell2
clear all;
hbar = 6.63e-34/(2*pi);
g=1;
n=0;
Wp=0.75;
A=0.03;

for Omega = 0.6:0.001:0.85;
    n=n+1;
    
    
    L0 = [0 0; 0 0];
    L0(39,39)=0;
    N0 = [6 0; 0 0];
    N0(39,39) = 0;
    U0 = [ (30/2 * g/(2*pi)) 0; 0 0];
    U0(39,39)=0;
    V0read = csvread('L0Vterm.csv');
    V0 = A.*V0read;
    
    L2 = [2*(1-Omega) 0; 0 2*(1-Omega)];
    L2(39,39)=0;
    N2 = eye(2).* 6;
    N2(39,39)=0;
    U2 = [ 29/2 *(g/(2*pi))   (sqrt(5)/2)*(g/(2*pi));
        (sqrt(5)/2)*(g/(2*pi))  (25/2)*(g/(2*pi)) ];
    U2(39,39)=0;
    V2read = csvread('L2VTerm.csv');
    V2 = A.*V2read;
    
    
    
    
    
    L4 = eye(5).*(4*(1-Omega));
    N4 = eye(5) .* 6;
    L4(39,39) =0;
    N4(39,39)=0;
    U4 = 
    V4read = csvread('L4VTerm.csv');
    V4 = A.*V4read;
    
    L6 = eye(11).*(6*(1-Omega));
    N6 = eye(11) .* 6;
    U6 = [ 1.6164 0.0272 0.0431 0.0000 0.0352 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0272 1.6612 0.0472 0.0629 0.0385 0.0629 0.0000 0.0000 0.0000 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0431 0.0472 1.4274 0.1592 0.0609 0.0796 0.0000 0.1194 0.0000 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0629 0.1592 1.6711 0.0000 0.0995 0.1194 0.0000 0.0597 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0352 0.0385 0.0609 0.0000 1.3230 0.1949 0.0000 0.0000 0.0000 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0629 0.0796 0.0995 0.1949 1.6114 0.2387 0.1194 0.2387 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0000 0.0000 0.1194 0.0000 0.2387 1.6711 0.0000 0.1194 0.1949 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0000 0.1194 0.0000 0.0000 0.1194 0.0000 1.3727 0.2387 0.0000 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0000 0.0000 0.0597 0.0000 0.2387 0.1194 0.2387 1.7308 0.3898 0.0000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.1949 0.0000 0.3898 1.6711 0.3082 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.3082 1.1937 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
    V6read = csvread('L6VTerm.csv');
    V6 = A.*V6read;
    
    
    
    
    Lmat0 = L0 ;
    Nmat0 = N0;
    Umat0 =  U0;
    Vmat0=V0;
    Totmat0 = Lmat0+Nmat0+Umat0+Vmat0;
    Eig0 = eig(Totmat0);
    
    Lmat2 = L2 ;
    Nmat2 = N2;
    Umat2 =  U2;
    Vmat2 = V2;
    Totmat2 = Lmat2+Nmat2+Umat2+Vmat2;
    Eig2 = eig(Totmat2);
    
    Lmat4 = L4 ;
    Nmat4 = N4;
    Umat4 =  U4;
    Vmat4 = V4;
    Totmat4 = Lmat4+Nmat4+Umat4+Vmat4;
    Eig4 = eig(Totmat4);
    
    Lmat6 = L6 ;
    Nmat6 = N6;
    Umat6 =  U6;
    Vmat6 = V6;
    Totmat6 = Lmat6+Nmat6+Umat6+Vmat6;
    Eig6 = eig(Totmat6);
    
    
    
    OmegaIncreaseMatrix(1,n) = Omega;
    OmegaEnergyMatrix0(:,n) = Eig0;
    OmegaEnergyMatrix2(:,n) = Eig2;
    OmegaEnergyMatrix4(:,n) = Eig4;
    OmegaEnergyMatrix6(:,n) = Eig6;
    
    
end

plot(OmegaIncreaseMatrix,OmegaEnergyMatrix0,OmegaIncreaseMatrix,OmegaEnergyMatrix2, OmegaIncreaseMatrix,OmegaEnergyMatrix4, OmegaIncreaseMatrix,OmegaEnergyMatrix6)
xlabel('Omega')
ylabel('<E>')
ylim([8 9.2])
%xlim([0.7 0.8])
